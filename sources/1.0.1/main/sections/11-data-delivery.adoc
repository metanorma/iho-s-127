
[[sec_11]]
== Data delivery

[[sec_11.1]]
=== Data product delivery information

This data product specification defines GML as the primary format
in which MTM data products are delivered. The delivery format is described
in <<table_11.1>> by the following items (from <<ISO_19131_2007>>): format
name, version, specification, language, character set.

[[table_11.1]]
.Data product delivery
[cols="3"]
|===
h| Name h| ISO 19131 Elements h| Value

| Format name | DPS_DeliveryInformation.deliveryFormat > DPS_DeliveryFormat.formatName
| GML footnote:note_eleven_one[GML is an XML encoding for the transport
and storage of geographic information, including both the geometry
and the properties of geographic features, between distributed systems.
The XML Schema for the GML application schema is provided in a schema
document S127.xsd which imports other schema(s) defining common types.
(All files are available on the S-100 distribution site https://github.com/IHO-S100WG ).
Feature instances must validate against S127.xsd and conform to all
other requirements specified in this data product specification including
all constraints not captured in the XML Schema document.]

| Version | DPS_DeliveryInformation.deliveryFormat > DPS_DeliveryFormat.version
| 3.2.1
| Specification description
| DPS_DeliveryInformation.deliveryFormat > DPS_DeliveryFormat.specification
| GML footnote:note_eleven_one[]

| Language | DPS_DeliveryInformation.deliveryFormat > DPS_DeliveryFormat.language
| English | Character set
| DPS_DeliveryInformation.deliveryFormat > DPS_DeliveryFormat.characterSet > MD_CharacterSetCode
| 004 -- utf8

|===

[[sec_11.1.1]]
==== Dataset loading

Datasets must always be loaded in the order of base dataset first,
then update datasets in the corrected sequential order. Systems are
not to load updates out of order, for example if update 1-5 is present,
then 6 is missing, update 7 must not be loaded.

[[sec_11.1.2]]
==== New editions

When a new edition of a dataset is received, the system must replace
the previous edition, along with any updates with the new edition
of the dataset. Loading of subsequent updates follow the same rule
as above.

[[sec_11.2]]
=== Dataset size

MTM datasets must not exceed 20MB.

Update datasets must not exceed 500KB.

[[sec_11.3]]
=== Exchange set

Data which conforms to this product specification must be delivered
by means of an exchange set.

An exchange set will consist of one or more MTM datasets. An exchange
set may also include one or more support files containing supplementary
information encoded in separate files. These are linked to the MTM
dataset features, by feature and information type attributes defined
in the application schema, e.g., *fileReference*. Each exchange set
will include a single (XML) catalogue file, S-127 exchange set catalogues
conform to S-100 4.0.0 <<fig_4>>a-D-2 without modification, containing
discovery metadata for each MTM dataset as well as support files.
S-127 Exchange set structure conforms to S-100 4.0.0 <<fig_4>>a-D-3
without modification.

[[fig_30]]
.Exchange set structure
image::figure-30.png[]

[[sec_11.4]]
=== Support files

Support files contain ancillary textual or graphic information in
separate (linked to the dataset) files. The following formats are
allowed for support files:

* Plain text files must contain only general text as defined in this
standard. Files must use the UTF-8 character set encoding.
* HTML and XML files must contain only text and markup as defined
in the relevant W3C standards. Files must use the UTF-8 character
set encoding. References in datasets to HTML and XML support files
must treat them as text files (i.e., they should not be referenced
using attributes intended for picture files).
* Picture files must be in the Tagged Image file Format
(TIFF) [Edition 6.0].

<<table_11.2>> describes the constraints on support file formats and
provides the corresponding file extensions.

[[table_11.2]]
.Support file formats and extensions
[cols="3"]
|===
h| File type h| Extension h| Description

.3+| Text
| TXT |
| HTM
| HTML files must only include inline or embedded Cascading Style
Sheet (CSS) information and must not contain embedded Javascript or
other dynamic content, for example DHTML, Flash etc.
| XML
| XML documents must only be included in accordance with guidance
provided within the Data Classification and Encoding Guide
(<<S127AnnexA>>) and must not contain embedded Javascript or other dynamic
content.
| Picture | TIF | Baseline TIFF 6.0.
|===


[[sec_11.5]]
=== Support file naming convention

All support files will have unique world-wide file identifiers.
The file identifier of support information should not be used to describe
the physical content of the file. The support file metadata that accompanies
the file will inform the user of the name and purpose of the file
(new, replacement and deletion).

In this encoding the support files are named according to the specifications
given below:

127CCCCXXXXXXXX.YYY

The main part forms an identifier where:

* The first three characters are always "127" and identify the dataset
as an S-127 dataset.
* The next four characters identify the issuing agency by its alphanumeric
agency code in the IHO producer code register in the IHO GI Registry
(i.e., the IHO is identified as "AA", not "1810"). Where the agency
code consists of fewer than four characters, sufficient zeros must
be suffixed to make the length exactly four characters
(e.g., "AA00" for IHO).
* The eighth up to the fifteenth character can be used in any way
by the producer to provide a unique file name for the dataset.
The following characters are allowed in the dataset name, A to Z,
0 to 9 and the special character _ (underscore). The ninth through
fifteenth characters are optional (i.e., at least one character must
be used).
* .YYY -- support file extension. The YYY portion must conform to
the file format as described in <<table_11.2>>.

[[sec_11.6]]
=== Dataset naming convention

All dataset files will have unique world-wide file identifiers.
The file identifier of the dataset should not be used to describe
the physical content of the file. The dataset file metadata that accompanies
the file will inform the user of the name and purpose of the file
(new, replacement, and deletion).

In this encoding the dataset files are named according to the specifications
given below:

127CCCCXXXXXXXXXX.GML

The main part forms an identifier where:

* The first three characters are always "127" and identify the dataset
as an S-127 dataset.
* The next four characters identify the issuing agency by its alphanumeric
agency code in the IHO producer code register in the IHO GI Registry
(i.e., the IHO is identified as "AA", not "1810"). Where the agency
code consists of fewer than four characters, sufficient zeros must
be suffixed to make the length exactly four characters
(e.g., "AA00" for IHO).
* The eighth up to the seventeenth character can be used in any way
by the producer to provide a unique file name for the dataset.
The following characters are allowed in the dataset name, A to Z,
0 to 9 and the special character _ (underscore). The ninth through
seventeenth characters are optional (i.e., at least one character
must be used).

[[sec_11.7]]
=== Update dataset naming convention

All update dataset files will have an identical name to the base dataset,
aside from the separator and update number sequence.

In this encoding the update dataset files are named according to the
specifications given below:

127CCCCXXXXXXXXXX_XXX.GML

The main part forms an identifier where:

* The first up to the seventeenth characters are the same as the dataset
being updated and therefore conform to the rules described in <<sec_11.6>>.
* The next character must be an underscore "_".
* The next three characters must be numerical (0-9) characters to
indicate the place of the update dataset in the update sequence.

[[sec_11.8]]
=== Catalogue file naming convention

The exchange catalogue acts as the table of contents for the exchange
set. The catalogue file of the exchange set must be named CATALOG.XML.
No other file in the exchange set may be named CATALOG.XML. The content
of the exchange catalogue file is described in <<sec_14>>.
